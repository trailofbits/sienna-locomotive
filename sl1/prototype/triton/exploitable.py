#!/usr/bin/env python

from triton import *
from pintool import *

class ExploitableRule(object):
  def score(self, state):
    '''
      Return an 'exploitability score'
    '''
    raise NotImplementedError("Subclasses must define score()")

class FaultInstructionOnStack(object):
  def score(self, state):
    stack = state.stack()
    pc = state.get_register(REG.RIP)
    score = 0

    if stack.has_address(pc):
      score += 10

    return score



Rules = [FaultInstructionOnStack]
